{
  "info": {
    "name": "Virtru DSP gRPC APIs",
    "description": "Comprehensive collection for interacting with Virtru Data Security Platform gRPC endpoints.\n\n**Services Included:**\n- Tagging PDP Service (v2)\n- Policy Artifact Service (v1)\n- NanoTDF Rewrap Service (v1)\n\n**Setup:**\n1. Configure environment variables (see Variables tab)\n2. Ensure your gRPC server is running\n3. Authentication token should be set in Authorization header",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "localhost:8080",
      "type": "string"
    },
    {
      "key": "auth_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "use_tls",
      "value": "false",
      "type": "boolean"
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{auth_token}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "Tagging PDP Service",
      "item": [
        {
          "name": "Tag Content Items",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"items\": [\n    {\n      \"desc\": {\n        \"type\": \"text.plain\",\n        \"id\": \"content-1\",\n        \"name\": \"sample.txt\"\n      },\n      \"text\": \"This is a sample document with sensitive information.\"\n    }\n  ],\n  \"type\": \"document\",\n  \"options\": {\n    \"mode\": \"ALL\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/tagging.pdp.v2.TaggingPDPService/Tag",
              "host": ["{{base_url}}"],
              "path": ["tagging.pdp.v2.TaggingPDPService", "Tag"]
            },
            "description": "Process content items through the PDP to produce tags.\n\n**Request Fields:**\n- `items`: Array of ContentItem objects\n- `type`: Optional top-level content type\n- `options`: TagRequestOptions with processing mode\n\n**Modes:**\n- ALL: Process all stages\n- TAG_EXTRACT: Content extraction + tag extraction\n- TAG_EXTRACT_AND_PROCESS: Extraction + processing\n- EXTRACT_GENERATE_TOKENS: Generate encrypted tokens"
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        },
        {
          "name": "Tag Per Content Item",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"items\": [\n    {\n      \"desc\": {\n        \"type\": \"email.header\",\n        \"id\": \"email-1\",\n        \"metadata\": {\n          \"from\": \"sender@example.com\",\n          \"to\": \"recipient@example.com\"\n        }\n      },\n      \"text\": \"Subject: Confidential Report\\nFrom: sender@example.com\"\n    },\n    {\n      \"desc\": {\n        \"type\": \"email.body.text\",\n        \"id\": \"email-2\"\n      },\n      \"text\": \"This email contains classified information about Project Alpha.\"\n    }\n  ],\n  \"options\": {\n    \"mode\": \"TAG_EXTRACT_AND_PROCESS\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/tagging.pdp.v2.TaggingPDPService/TagPerContentItem",
              "host": ["{{base_url}}"],
              "path": ["tagging.pdp.v2.TaggingPDPService", "TagPerContentItem"]
            },
            "description": "Process content items and return tags per individual content item plus cross-content tags.\n\n**Response includes:**\n- `cross_content_tags`: Tags rolled up across all content\n- `per_content_tags`: Tags specific to each content item\n- `events`: Processing events/errors"
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        },
        {
          "name": "Process Tags",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tags\": [\n    {\n      \"metadata\": {\n        \"id\": \"tag-1\"\n      },\n      \"data_attribute\": {\n        \"fqn\": \"https://example.com/attr/namespace/attr/name/Classification\"\n      }\n    }\n  ],\n  \"options\": {\n    \"mode\": \"PROCESS\",\n    \"assertion_options\": [\n      {\n        \"assertion_type\": \"stanag_4774\"\n      }\n    ]\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/tagging.pdp.v2.TaggingPDPService/ProcessTags",
              "host": ["{{base_url}}"],
              "path": ["tagging.pdp.v2.TaggingPDPService", "ProcessTags"]
            },
            "description": "Process a series of tags through the PDP.\n\n**Options:**\n- `mode`: ALL or PROCESS\n- `assertion_options`: Generate assertions (e.g., STANAG 4774)\n\n**Use Cases:**\n- Convert data attribute tags to assertions\n- Process third-party tags\n- Generate encrypted search tokens"
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        },
        {
          "name": "Tag with Binary Content",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"items\": [\n    {\n      \"desc\": {\n        \"type\": \"application.pdf\",\n        \"id\": \"doc-1\",\n        \"name\": \"confidential.pdf\",\n        \"generateTokens\": true\n      },\n      \"binaryContent\": \"<base64-encoded-pdf-content>\"\n    }\n  ],\n  \"options\": {\n    \"mode\": \"EXTRACT_GENERATE_TOKENS\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/tagging.pdp.v2.TaggingPDPService/Tag",
              "host": ["{{base_url}}"],
              "path": ["tagging.pdp.v2.TaggingPDPService", "Tag"]
            },
            "description": "Tag binary content (PDF, Office docs, images, etc.)\n\n**Binary Content Handling:**\n- Use `binaryContent` field with base64-encoded data\n- Set `generateTokens: true` to generate encrypted search tokens\n- Content type affects extraction methods"
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        }
      ],
      "description": "Tagging PDP Service provides content analysis and tag generation capabilities.\n\n**Key Features:**\n- Content extraction from multiple formats\n- Tag generation based on rules and ML\n- Assertion generation (STANAG, custom formats)\n- Encrypted search token generation\n- Provenance tracking"
    },
    {
      "name": "Policy Artifact Service",
      "item": [
        {
          "name": "Import Policy (Unbundled)",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"policy_unbundled\": {\n    \"policy\": \"<base64-encoded-yaml-policy>\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/policyimportexport.v1.PolicyArtifactService/CreateImportArtifacts",
              "host": ["{{base_url}}"],
              "path": ["policyimportexport.v1.PolicyArtifactService", "CreateImportArtifacts"]
            },
            "description": "Import policy artifacts in unbundled YAML format.\n\n**Policy Format:**\nBase64-encoded YAML containing:\n- Namespaces\n- Attributes\n- Values\n- Subject mappings\n- Resource mappings"
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        },
        {
          "name": "Import Policy (OCI Bundle)",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"policy_oci_bundle\": {\n    \"oci_blob\": \"<signed-oci-artifact-blob>\",\n    \"no_verify_signature\": false\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/policyimportexport.v1.PolicyArtifactService/CreateImportArtifacts",
              "host": ["{{base_url}}"],
              "path": ["policyimportexport.v1.PolicyArtifactService", "CreateImportArtifacts"]
            },
            "description": "Import policy artifacts as signed OCI bundles.\n\n**Security:**\n- Signature verification by default\n- Requires trusted artifact provider\n- Set `no_verify_signature: true` only for testing"
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        },
        {
          "name": "Export Policy (Unbundled)",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"namespace\": \"https://example.com/attr\",\n  \"no_bundle\": true,\n  \"with_obligations\": true\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/policyimportexport.v1.PolicyArtifactService/CreateExportArtifacts",
              "host": ["{{base_url}}"],
              "path": ["policyimportexport.v1.PolicyArtifactService", "CreateExportArtifacts"]
            },
            "description": "Export policy artifacts for a specific namespace in YAML format.\n\n**Options:**\n- `namespace`: Namespace to export\n- `no_bundle`: Export as unbundled YAML (true) or OCI artifact (false)\n- `with_obligations`: Include obligations in export (default: true)"
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        },
        {
          "name": "Export Policy (OCI Bundle)",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"namespace\": \"https://example.com/attr\",\n  \"no_bundle\": false,\n  \"with_obligations\": true\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/policyimportexport.v1.PolicyArtifactService/CreateExportArtifacts",
              "host": ["{{base_url}}"],
              "path": ["policyimportexport.v1.PolicyArtifactService", "CreateExportArtifacts"]
            },
            "description": "Export policy artifacts as an OCI bundle.\n\n**Returns:**\n- JSON manifest\n- OCI-layout tar archive\n\nReady for signing and distribution via OCI registries."
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        },
        {
          "name": "Create Trusted Artifact Provider",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"artifact_provider\": {\n    \"public_key\": \"<base64-encoded-public-key>\",\n    \"permitted_namespaces\": [\n      \"https://example.com/attr\",\n      \"https://virtru.com/attr\"\n    ]\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/policyimportexport.v1.PolicyArtifactService/CreateTrustedArtifactProvider",
              "host": ["{{base_url}}"],
              "path": ["policyimportexport.v1.PolicyArtifactService", "CreateTrustedArtifactProvider"]
            },
            "description": "Register a trusted policy artifact provider for signature verification.\n\n**Required:**\n- Public key for signature verification\n- Permitted namespaces the provider can publish\n\n**Use Case:**\nAllow external policy providers to publish signed policy artifacts."
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        }
      ],
      "description": "Policy Artifact Service manages policy import/export in various formats.\n\n**Formats:**\n- Unbundled YAML\n- OCI artifacts (signed)\n\n**Features:**\n- Signature verification\n- Trusted provider management\n- Namespace isolation"
    },
    {
      "name": "NanoTDF Rewrap Service",
      "item": [
        {
          "name": "Rewrap NanoTDF Headers",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"signed_request_token\": \"<signed-jwt-token>\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/kas.nanotdf.v1.NanoTDFRewrapService/Rewrap",
              "host": ["{{base_url}}"],
              "path": ["kas.nanotdf.v1.NanoTDFRewrapService", "Rewrap"]
            },
            "description": "Rewrap NanoTDF headers to obtain KAS-wrapped keys.\n\n**Signed Request Token (SRT) must contain:**\n```json\n{\n  \"requestBody\": {\n    \"client_public_key\": \"<x25519-public-key>\",\n    \"items\": [\n      {\n        \"id\": \"item-1\",\n        \"header\": \"<base64-nanotdf-header>\"\n      }\n    ]\n  }\n}\n```\n\n**Response includes:**\n- Session public key for key agreement\n- Per-item rewrap results with KAS-wrapped keys\n- Status: \"permit\" or \"fail\""
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        }
      ],
      "description": "NanoTDF Rewrap Service handles key management for NanoTDF format.\n\n**Features:**\n- KAS-based key rewrapping\n- Support for batch rewrap operations\n- X25519 key agreement\n- Per-item status tracking"
    },
    {
      "name": "Health Check",
      "item": [
        {
          "name": "gRPC Health Check",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"service\": \"\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/grpc.health.v1.Health/Check",
              "host": ["{{base_url}}"],
              "path": ["grpc.health.v1.Health", "Check"]
            },
            "description": "Standard gRPC health check.\n\n**Empty service name checks overall server health.**\n\nResponses:\n- SERVING: Service is healthy\n- NOT_SERVING: Service is down\n- UNKNOWN: Status unknown"
          },
          "response": [],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          }
        }
      ],
      "description": "Standard gRPC health check endpoints"
    }
  ]
}
